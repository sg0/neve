NVCC:=nvcc

SM=70
#check=1
ifeq ($(debug), 1)
	CUFLAGS = -g -G -Ddebug --std=c++14 --gpu-architecture=compute_${SM} --gpu-code=sm_${SM},compute_${SM} \
                  -Xcompiler -fopenmp
else 
	CUFLAGS = -O3 -Xptxas -O3 --std=c++14 --gpu-architecture=compute_${SM} --gpu-code=sm_${SM},compute_${SM} \
                  -Xcompiler -O3 -Xcompiler -fopenmp
endif

ifeq ($(bit),32)
	CUFLAGS += -DUSE_32BIT
	CFLAGS  += -DUSE_32BIT
else ifeq ($(bit),64)
	CUFLAGS += -DUSE_64BIT
	CFLAGS  += -DUSE_64BIT
else
	CUFLAGS += -DUSE_64BIT
	CFLAGS  += DUSE_64BIT
endif

EXE:= test_bandwidth

all: ${EXE}

main.o: main.cu
	${NVCC} ${CUFLAGS} -c $< -o $@

${EXE}: main.o
	${NVCC} ${CUFLAGS} $^ -o $@
clean:
	rm -f *.o ${EXE}
